<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPR Medications Learning System v2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .card-flip {
            perspective: 1000px;
        }
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .card-flip.flipped .card-inner {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 12px;
            padding: 24px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .card-back {
            transform: rotateY(180deg);
        }
        .progress-bar {
            transition: width 0.3s ease;
        }
        .quiz-option {
            transition: all 0.3s ease;
        }
        .quiz-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .quiz-option.correct {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        .quiz-option.incorrect {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
        .quiz-option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .nav-tab {
            transition: all 0.3s ease;
        }
        .nav-tab.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 min-h-full">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-5xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4">
                üíä CPR Medications Learning System v2
            </h1>
            <p class="text-gray-600 text-lg">‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏¢‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
        </div>

        <!-- Navigation Tabs -->
        <div class="flex justify-center mb-8">
            <div class="bg-white rounded-xl p-2 shadow-lg">
                <button onclick="switchMode('flashcards')" class="nav-tab active px-8 py-3 rounded-lg font-medium" id="flashcards-tab">
                    üìö Flash Cards
                </button>
                <button onclick="switchMode('quiz')" class="nav-tab px-8 py-3 rounded-lg font-medium text-gray-600" id="quiz-tab">
                    üß† ‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö
                </button>
                <button onclick="switchMode('results')" class="nav-tab px-8 py-3 rounded-lg font-medium text-gray-600" id="results-tab">
                    üìä ‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                </button>
            </div>
        </div>

        <!-- Flash Cards Mode -->
        <div id="flashcards-mode" class="mode-content">
            <!-- Progress Bar -->
            <div class="mb-6 bg-white rounded-xl p-6 shadow-lg">
                <div class="flex justify-between items-center mb-3">
                    <span class="text-lg font-semibold text-gray-700">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</span>
                    <span class="text-lg text-gray-600 font-medium" id="progress-text">0/15</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-4">
                    <div class="progress-bar bg-gradient-to-r from-green-400 via-blue-500 to-purple-500 h-4 rounded-full" id="progress-bar" style="width: 0%"></div>
                </div>
            </div>

            <!-- Controls -->
            <div class="flex flex-wrap gap-4 mb-6 justify-center">
                <button onclick="shuffleCards()" class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-8 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg">
                    üîÄ ‡∏™‡∏•‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î
                </button>
                <button onclick="resetProgress()" class="bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white px-8 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg">
                    üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
                </button>
                <button onclick="showAll()" class="bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-700 hover:to-blue-700 text-white px-8 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg">
                    üëÅÔ∏è ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
            </div>

            <!-- Filter Buttons -->
            <div class="flex flex-wrap gap-3 mb-8 justify-center">
                <button onclick="filterCards('all')" class="filter-btn bg-gradient-to-r from-gray-600 to-gray-700 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all transform hover:scale-105 shadow-md">
                    ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
                <button onclick="filterCards('vasopressor')" class="filter-btn bg-gradient-to-r from-red-500 to-red-600 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all transform hover:scale-105 shadow-md">
                    üü• Vasopressor
                </button>
                <button onclick="filterCards('antiarrhythmic')" class="filter-btn bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all transform hover:scale-105 shadow-md">
                    üü¶ Antiarrhythmic
                </button>
                <button onclick="filterCards('anticholinergic')" class="filter-btn bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all transform hover:scale-105 shadow-md">
                    üü© Anticholinergic
                </button>
                <button onclick="filterCards('svt')" class="filter-btn bg-gradient-to-r from-yellow-500 to-yellow-600 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all transform hover:scale-105 shadow-md">
                    üü® SVT Therapy
                </button>
                <button onclick="filterCards('electrolyte')" class="filter-btn bg-gradient-to-r from-purple-500 to-purple-600 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all transform hover:scale-105 shadow-md">
                    üü™ Electrolyte
                </button>
                <button onclick="filterCards('metabolic')" class="filter-btn bg-gradient-to-r from-indigo-500 to-indigo-600 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all transform hover:scale-105 shadow-md">
                    üü£ Metabolic
                </button>
                <button onclick="filterCards('inotropic')" class="filter-btn bg-gradient-to-r from-rose-500 to-rose-600 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all transform hover:scale-105 shadow-md">
                    üî¥ Inotropic
                </button>
                <button onclick="filterCards('thrombolytic')" class="filter-btn bg-gradient-to-r from-red-600 to-red-700 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all transform hover:scale-105 shadow-md">
                    ü©∏ Thrombolytic
                </button>
                <button onclick="filterCards('diuretic')" class="filter-btn bg-gradient-to-r from-cyan-500 to-cyan-600 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all transform hover:scale-105 shadow-md">
                    üíß Diuretic
                </button>
            </div>

            <!-- Flash Cards Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="cards-container">
                <!-- Cards will be generated by JavaScript -->
            </div>

            <!-- Study Stats -->
            <div class="mt-8 bg-white rounded-xl p-8 shadow-lg">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl border border-green-200">
                        <div class="text-3xl font-bold text-green-600" id="studied-count">0</div>
                        <div class="text-sm text-gray-600 mt-1">‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡πâ‡∏ß</div>
                    </div>
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200">
                        <div class="text-3xl font-bold text-blue-600" id="remaining-count">15</div>
                        <div class="text-sm text-gray-600 mt-1">‡πÄ‡∏´‡∏•‡∏∑‡∏≠</div>
                    </div>
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-xl border border-purple-200">
                        <div class="text-3xl font-bold text-purple-600" id="total-flips">0</div>
                        <div class="text-sm text-gray-600 mt-1">‡∏û‡∏•‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                    </div>
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-xl border border-orange-200">
                        <div class="text-3xl font-bold text-orange-600" id="completion-rate">0%</div>
                        <div class="text-sm text-gray-600 mt-1">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quiz Mode -->
        <div id="quiz-mode" class="mode-content hidden">
            <div class="max-w-4xl mx-auto">
                <!-- Quiz Header -->
                <div class="bg-white rounded-xl p-8 shadow-lg mb-8">
                    <div class="text-center">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4">üß† ‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡∏¢‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</h2>
                        <div class="flex justify-center items-center space-x-8 text-lg">
                            <div class="text-blue-600 font-semibold">
                                ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà <span id="current-question">1</span> / <span id="total-questions">10</span>
                            </div>
                            <div class="text-green-600 font-semibold">
                                ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="current-score">0</span>
                            </div>
                            <div class="text-purple-600 font-semibold">
                                ‡πÄ‡∏ß‡∏•‡∏≤: <span id="quiz-timer">00:00</span>
                            </div>
                        </div>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3 mt-6">
                        <div class="bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full transition-all duration-300" id="quiz-progress" style="width: 10%"></div>
                    </div>
                </div>

                <!-- Quiz Question -->
                <div class="bg-white rounded-xl p-8 shadow-lg mb-6 fade-in" id="quiz-container">
                    <div class="text-center mb-8">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4" id="question-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°...</h3>
                        <div class="text-gray-600" id="question-category"></div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="quiz-options">
                        <!-- Options will be generated by JavaScript -->
                    </div>
                    
                    <div class="text-center mt-8">
                        <button onclick="nextQuestion()" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed" id="next-btn" disabled>
                            ‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí
                        </button>
                    </div>
                </div>

                <!-- Quiz Controls -->
                <div class="text-center">
                    <button onclick="startQuiz()" class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white px-8 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg mr-4" id="start-quiz-btn">
                        üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö
                    </button>
                    <button onclick="resetQuiz()" class="bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white px-8 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg">
                        üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
                    </button>
                </div>
            </div>
        </div>

        <!-- Results Mode -->
        <div id="results-mode" class="mode-content hidden">
            <div class="max-w-4xl mx-auto">
                <div class="bg-white rounded-xl p-8 shadow-lg">
                    <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h2>
                    
                    <!-- Summary Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200 text-center">
                            <div class="text-3xl font-bold text-blue-600" id="total-attempts">0</div>
                            <div class="text-sm text-gray-600 mt-1">‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ö</div>
                        </div>
                        <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl border border-green-200 text-center">
                            <div class="text-3xl font-bold text-green-600" id="average-score">0%</div>
                            <div class="text-sm text-gray-600 mt-1">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                        </div>
                        <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-xl border border-purple-200 text-center">
                            <div class="text-3xl font-bold text-purple-600" id="best-score">0%</div>
                            <div class="text-sm text-gray-600 mt-1">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</div>
                        </div>
                    </div>

                    <!-- Results Table -->
                    <div class="overflow-x-auto">
                        <table class="w-full table-auto">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡πÄ‡∏Å‡∏£‡∏î</th>
                                </tr>
                            </thead>
                            <tbody id="results-table" class="bg-white divide-y divide-gray-200">
                                <!-- Results will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <div class="text-center mt-8">
                        <button onclick="exportResults()" class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white px-8 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg mr-4">
                            üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                        </button>
                        <button onclick="clearResults()" class="bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white px-8 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg">
                            üóëÔ∏è ‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Medications data
        const medications = [
            {
                id: 1,
                category: 'vasopressor',
                categoryName: 'üü• Vasopressor / Sympathomimetic',
                name: 'Epinephrine (Adrenaline)',
                mechanism: '‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô Œ± & Œ≤ adrenergic',
                indication: 'CPR, ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏´‡∏±‡∏ß‡πÉ‡∏à/‡∏™‡∏°‡∏≠‡∏á',
                dosage: '1 mg IV/IO ‡∏ó‡∏∏‡∏Å 3‚Äì5 ‡∏ô‡∏≤‡∏ó‡∏µ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡∏™‡∏°)',
                caution: 'Arrhythmias, Pulmonary edema, Pupils ‡∏Ç‡∏¢‡∏≤‡∏¢',
                color: 'bg-red-500'
            },
            {
                id: 2,
                category: 'antiarrhythmic',
                categoryName: 'üü¶ Antiarrhythmic',
                name: 'Amiodarone',
                mechanism: '‡∏¢‡∏±‡∏ö‡∏¢‡∏±‡πâ‡∏á‡∏ä‡πà‡∏≠‡∏á Na+/K+/Ca2+',
                indication: 'Antiarrhythmic (AF, VT, VF)',
                dosage: '300 mg IV/IO bolus ‚Üí 150 mg ‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (‡∏ú‡∏™‡∏° 20‚Äì30 mL D5W)',
                caution: 'QTc prolong, Bradycardia, Hypotension, ‡∏ï‡∏±‡∏ö',
                color: 'bg-blue-500'
            },
            {
                id: 3,
                category: 'antiarrhythmic',
                categoryName: 'üü¶ Antiarrhythmic',
                name: 'Lidocaine',
                mechanism: 'Class Ib ‚Üí ‡∏•‡∏î excitability ‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à',
                indication: 'VT/VF resistant',
                dosage: '1‚Äì1.5 mg/kg IV/IO bolus ‚Üí 0.5‚Äì0.75 mg/kg ‡∏ó‡∏∏‡∏Å 5‚Äì10 ‡∏ô‡∏≤‡∏ó‡∏µ (Dilute ‡∏Å‡∏±‡∏ö NSS/D5W)',
                caution: 'Seizure, Bradycardia, CNS toxicity',
                color: 'bg-blue-500'
            },
            {
                id: 4,
                category: 'anticholinergic',
                categoryName: 'üü© Anticholinergic',
                name: 'Atropine',
                mechanism: '‡∏ï‡πâ‡∏≤‡∏ô Muscarinic (Ach)',
                indication: 'Bradycardia',
                dosage: '0.5 mg IV ‡∏ó‡∏∏‡∏Å 3‚Äì5 ‡∏ô‡∏≤‡∏ó‡∏µ, max 3 mg (‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ)',
                caution: '‡∏ó‡πâ‡∏≠‡∏á‡∏ú‡∏π‡∏Å, ‡πÉ‡∏à‡∏™‡∏±‡πà‡∏ô, ‡∏ï‡∏≤‡∏û‡∏£‡πà‡∏≤',
                color: 'bg-green-500'
            },
            {
                id: 5,
                category: 'svt',
                categoryName: 'üü® SVT Therapy',
                name: 'Adenosine',
                mechanism: '‡∏ä‡∏∞‡∏•‡∏≠ SA & AV node',
                indication: 'SVT (‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÄ‡∏ï‡πâ‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏´‡πâ‡∏≠‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à)',
                dosage: '6 mg IV rapid push ‚Üí 12 mg ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö, flush 20 mL NSS',
                caution: 'AV block, ‡∏´‡∏≠‡∏ö‡∏´‡∏∑‡∏î, Hypersensitivity',
                color: 'bg-yellow-500'
            },
            {
                id: 6,
                category: 'electrolyte',
                categoryName: 'üü™ Electrolyte / Metabolic',
                name: 'Magnesium sulfate 50%',
                mechanism: '‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏î‡∏∏‡∏• Mg ‡πÉ‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à',
                indication: 'Torsades de pointes, Hypomagnesemia',
                dosage: '1‚Äì2 g IV dilute 10 mL D5W over 5‚Äì20 min',
                caution: '‡∏Å‡∏î‡∏´‡∏≤‡∏¢‡πÉ‡∏à, ‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏≠‡πà‡∏≠‡∏ô‡πÅ‡∏£‡∏á, ‡∏á‡πà‡∏ß‡∏á‡∏ã‡∏∂‡∏°',
                color: 'bg-purple-500'
            },
            {
                id: 7,
                category: 'electrolyte',
                categoryName: 'üü™ Electrolyte / Metabolic',
                name: 'Sodium bicarbonate 7.5%',
                mechanism: '‡∏õ‡∏£‡∏±‡∏ö pH ‡πÄ‡∏•‡∏∑‡∏≠‡∏î',
                indication: 'Hyperkalemia, TCA overdose',
                dosage: '1 mEq/kg IV bolus, dilute 50 mL D5W/NSS',
                caution: 'Extravasation ‚Üí tissue necrosis',
                color: 'bg-purple-500'
            },
            {
                id: 8,
                category: 'electrolyte',
                categoryName: 'üü™ Electrolyte / Metabolic',
                name: 'Calcium gluconate',
                mechanism: '‡πÄ‡∏û‡∏¥‡πà‡∏° Ca ‡πÉ‡∏ô‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏±‡∏ß‡πÉ‡∏à',
                indication: 'Hyperkalemia, Hypocalcemia, Ca blocker OD',
                dosage: 'Calcium gluconate 1-2 ampules IV slow push',
                caution: '‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏π‡πà Sodium bicarbonate',
                color: 'bg-purple-500'
            },
            {
                id: 9,
                category: 'metabolic',
                categoryName: 'üü£ Metabolic Support',
                name: 'Glucose 50%',
                mechanism: '‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô & ‡∏™‡∏á‡∏ß‡∏ô‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô',
                indication: 'Hypoglycemia',
                dosage: '25-50 mL IV push (‡∏ï‡∏£‡∏ß‡∏à glucose ‡∏Å‡πà‡∏≠‡∏ô)',
                caution: 'Hyperglycemia, Pulmonary edema, Hypersensitivity',
                color: 'bg-indigo-500'
            },
            {
                id: 10,
                category: 'inotropic',
                categoryName: 'üî¥ Inotropic / Vasopressor',
                name: 'Dobutamine',
                mechanism: 'Œ≤1 agonist ‚Üí ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏á‡∏ö‡∏µ‡∏ö‡∏´‡∏±‡∏ß‡πÉ‡∏à',
                indication: 'Heart failure, Cardiogenic shock',
                dosage: '2.5-15 mcg/kg/min IV infusion',
                caution: 'Tachycardia, Arrhythmias, Hypotension',
                color: 'bg-rose-600'
            },
            {
                id: 11,
                category: 'inotropic',
                categoryName: 'üî¥ Inotropic / Vasopressor',
                name: 'Dopamine',
                mechanism: 'Dopamine + Œ±/Œ≤ agonist',
                indication: 'Shock, ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏á‡∏ö‡∏µ‡∏ö‡∏´‡∏±‡∏ß‡πÉ‡∏à & ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î',
                dosage: '5-20 mcg/kg/min IV infusion',
                caution: 'Tachycardia, Arrhythmias, Extravasation',
                color: 'bg-rose-600'
            },
            {
                id: 12,
                category: 'inotropic',
                categoryName: 'üî¥ Inotropic / Vasopressor',
                name: 'Norepinephrine',
                mechanism: 'Œ±1 > Œ≤1 agonist ‚Üí ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î',
                indication: 'Septic shock, Hypotension',
                dosage: '0.1-2 mcg/kg/min IV infusion',
                caution: 'Severe vasoconstriction, Extravasation',
                color: 'bg-rose-600'
            },
            {
                id: 13,
                category: 'thrombolytic',
                categoryName: 'ü©∏ Emergency Thrombolytic',
                name: 'Streptokinase',
                mechanism: '‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏•‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏î',
                indication: 'STEMI, Massive PE, Stroke',
                dosage: '1.5 million units IV over 60 min',
                caution: 'Bleeding, Allergic reactions, Hypotension',
                color: 'bg-red-700'
            },
            {
                id: 14,
                category: 'thrombolytic',
                categoryName: 'ü©∏ Emergency Thrombolytic',
                name: 'rtPA',
                mechanism: '‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏•‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏î (tissue specific)',
                indication: 'STEMI, Stroke, PE',
                dosage: '0.9 mg/kg (10% bolus 1 minute then 90% infusion 1 hour)',
                caution: 'ICH risk, Bleeding, Time window critical',
                color: 'bg-red-700'
            },
            {
                id: 15,
                category: 'diuretic',
                categoryName: 'üíß Diuretic',
                name: 'Furosemide',
                mechanism: '‡∏Ç‡∏±‡∏ö Na+/‡∏ô‡πâ‡∏≥‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÑ‡∏ï',
                indication: 'CHF, Edema, Hypertension',
                dosage: '20-80 mg IV/PO (‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏Å‡∏≤‡∏£)',
                caution: 'Ototoxicity, Hypovolemia, Hypokalemia',
                color: 'bg-cyan-600'
            }
        ];

        // Quiz questions
        const quizQuestions = [
            {
                question: "‡∏¢‡∏≤‡πÉ‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏¢‡∏≤‡πÅ‡∏£‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ CPR?",
                options: ["Amiodarone", "Epinephrine", "Atropine", "Lidocaine"],
                correct: 1,
                category: "vasopressor",
                explanation: "Epinephrine ‡πÄ‡∏õ‡πá‡∏ô‡∏¢‡∏≤‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô CPR ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏≠‡∏á"
            },
            {
                question: "‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤ Epinephrine ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô CPR ‡∏Ñ‡∏∑‡∏≠?",
                options: ["0.5 mg ‡∏ó‡∏∏‡∏Å 3-5 ‡∏ô‡∏≤‡∏ó‡∏µ", "1 mg ‡∏ó‡∏∏‡∏Å 3-5 ‡∏ô‡∏≤‡∏ó‡∏µ", "2 mg ‡∏ó‡∏∏‡∏Å 3-5 ‡∏ô‡∏≤‡∏ó‡∏µ", "0.1 mg ‡∏ó‡∏∏‡∏Å 3-5 ‡∏ô‡∏≤‡∏ó‡∏µ"],
                correct: 1,
                category: "vasopressor",
                explanation: "‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤ Epinephrine ‡πÉ‡∏ô CPR ‡∏Ñ‡∏∑‡∏≠ 1 mg IV/IO ‡∏ó‡∏∏‡∏Å 3-5 ‡∏ô‡∏≤‡∏ó‡∏µ"
            },
            {
                question: "‡∏¢‡∏≤‡πÉ‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤ SVT (Supraventricular Tachycardia)?",
                options: ["Adenosine", "Amiodarone", "Lidocaine", "Atropine"],
                correct: 0,
                category: "svt",
                explanation: "Adenosine ‡πÄ‡∏õ‡πá‡∏ô‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤ SVT ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡∏∞‡∏•‡∏≠ SA ‡πÅ‡∏•‡∏∞ AV node"
            },
            {
                question: "‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤ Adenosine ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤ SVT ‡∏Ñ‡∏∑‡∏≠?",
                options: ["3 mg ‚Üí 6 mg", "6 mg ‚Üí 12 mg", "12 mg ‚Üí 18 mg", "1 mg ‚Üí 2 mg"],
                correct: 1,
                category: "svt",
                explanation: "‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤ Adenosine ‡∏Ñ‡∏∑‡∏≠ 6 mg IV rapid push ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢ 12 mg ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á"
            },
            {
                question: "‡∏¢‡∏≤‡πÉ‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤ Torsades de pointes?",
                options: ["Calcium gluconate", "Magnesium sulfate", "Sodium bicarbonate", "Atropine"],
                correct: 1,
                category: "electrolyte",
                explanation: "Magnesium sulfate ‡πÉ‡∏ä‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤ Torsades de pointes ‡πÅ‡∏•‡∏∞ Hypomagnesemia"
            },
            {
                question: "‡∏¢‡∏≤‡πÉ‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤ Bradycardia?",
                options: ["Epinephrine", "Atropine", "Amiodarone", "Adenosine"],
                correct: 1,
                category: "anticholinergic",
                explanation: "Atropine ‡πÉ‡∏ä‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤ Symptomatic bradycardia ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πâ‡∏≤‡∏ô Muscarinic receptor"
            },
            {
                question: "‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á Amiodarone ‡∏Ñ‡∏∑‡∏≠?",
                options: ["Hyperkalemia", "QTc prolongation", "Hypoglycemia", "Respiratory depression"],
                correct: 1,
                category: "antiarrhythmic",
                explanation: "Amiodarone ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î QTc prolongation, Bradycardia ‡πÅ‡∏•‡∏∞ Hypotension"
            },
            {
                question: "‡∏¢‡∏≤‡πÉ‡∏î‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö Sodium bicarbonate?",
                options: ["Epinephrine", "Calcium gluconate", "Magnesium sulfate", "Atropine"],
                correct: 1,
                category: "electrolyte",
                explanation: "‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏´‡πâ Calcium gluconate ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö Sodium bicarbonate ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡∏ï‡∏∞‡∏Å‡∏≠‡∏ô"
            },
            {
                question: "‡∏Å‡∏•‡πÑ‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Furosemide ‡∏Ñ‡∏∑‡∏≠?",
                options: ["‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô Œ≤ receptor", "‡∏¢‡∏±‡∏ö‡∏¢‡∏±‡πâ‡∏á‡∏ä‡πà‡∏≠‡∏á Na+", "‡∏Ç‡∏±‡∏ö Na+/‡∏ô‡πâ‡∏≥‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÑ‡∏ï", "‡∏ï‡πâ‡∏≤‡∏ô Muscarinic"],
                correct: 2,
                category: "diuretic",
                explanation: "Furosemide ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏ö Na+ ‡πÅ‡∏•‡∏∞‡∏ô‡πâ‡∏≥‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÑ‡∏ï ‡πÉ‡∏ä‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤ CHF ‡πÅ‡∏•‡∏∞ Edema"
            },
            {
                question: "‡∏¢‡∏≤‡πÉ‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏•‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô?",
                options: ["Heparin", "Warfarin", "Streptokinase", "Aspirin"],
                correct: 2,
                category: "thrombolytic",
                explanation: "Streptokinase ‡πÅ‡∏•‡∏∞ rtPA ‡πÄ‡∏õ‡πá‡∏ô‡∏¢‡∏≤‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏•‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô ‡πÄ‡∏ä‡πà‡∏ô STEMI, PE, Stroke"
            }
        ];

        // Global variables
        let studiedCards = new Set();
        let totalFlips = 0;
        let currentFilter = 'all';
        let currentMode = 'flashcards';
        let quizState = {
            currentQuestion: 0,
            score: 0,
            answers: [],
            startTime: null,
            timer: null
        };
        let quizResults = JSON.parse(localStorage.getItem('quizResults')) || [];

        // Mode switching
        function switchMode(mode) {
            currentMode = mode;
            
            // Update tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.classList.add('text-gray-600');
            });
            document.getElementById(`${mode}-tab`).classList.add('active');
            document.getElementById(`${mode}-tab`).classList.remove('text-gray-600');
            
            // Show/hide content
            document.querySelectorAll('.mode-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${mode}-mode`).classList.remove('hidden');
            
            if (mode === 'results') {
                loadResults();
            }
        }

        // Flash Cards Functions
        function createCard(med) {
            return `
                <div class="card-flip h-80 cursor-pointer" data-id="${med.id}" data-category="${med.category}" onclick="flipCard(${med.id})">
                    <div class="card-inner">
                        <div class="card-front ${med.color} text-white shadow-xl rounded-xl">
                            <div class="text-center">
                                <h3 class="text-xl font-bold mb-2">${med.name}</h3>
                                <p class="text-sm opacity-90 mb-4">${med.categoryName}</p>
                                <div class="text-6xl mb-4">üíä</div>
                                <p class="text-sm opacity-75">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</p>
                            </div>
                        </div>
                        <div class="card-back bg-white shadow-xl border-l-4 ${med.color.replace('bg-', 'border-')} rounded-xl">
                            <div class="text-left space-y-3 text-sm">
                                <div>
                                    <strong class="text-gray-700">‡∏Å‡∏•‡πÑ‡∏Å:</strong>
                                    <p class="text-gray-600">${med.mechanism}</p>
                                </div>
                                <div>
                                    <strong class="text-gray-700">‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:</strong>
                                    <p class="text-gray-600">${med.indication}</p>
                                </div>
                                <div>
                                    <strong class="text-gray-700">‡∏Ç‡∏ô‡∏≤‡∏î:</strong>
                                    <p class="text-gray-600">${med.dosage}</p>
                                </div>
                                <div>
                                    <strong class="text-red-600">‡∏£‡∏∞‡∏ß‡∏±‡∏á:</strong>
                                    <p class="text-red-500">${med.caution}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCards() {
            const container = document.getElementById('cards-container');
            const filteredMeds = currentFilter === 'all' ? medications : medications.filter(med => med.category === currentFilter);
            container.innerHTML = filteredMeds.map(createCard).join('');
        }

        function flipCard(id) {
            const card = document.querySelector(`[data-id="${id}"]`);
            card.classList.toggle('flipped');
            
            if (!studiedCards.has(id)) {
                studiedCards.add(id);
                updateProgress();
            }
            
            totalFlips++;
            updateStats();
        }

        function updateProgress() {
            const progress = (studiedCards.size / medications.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
            document.getElementById('progress-text').textContent = `${studiedCards.size}/${medications.length}`;
        }

        function updateStats() {
            document.getElementById('studied-count').textContent = studiedCards.size;
            document.getElementById('remaining-count').textContent = medications.length - studiedCards.size;
            document.getElementById('total-flips').textContent = totalFlips;
            document.getElementById('completion-rate').textContent = `${Math.round((studiedCards.size / medications.length) * 100)}%`;
        }

        function shuffleCards() {
            medications.sort(() => Math.random() - 0.5);
            renderCards();
        }

        function resetProgress() {
            studiedCards.clear();
            totalFlips = 0;
            document.querySelectorAll('.card-flip').forEach(card => {
                card.classList.remove('flipped');
            });
            updateProgress();
            updateStats();
        }

        function showAll() {
            document.querySelectorAll('.card-flip').forEach(card => {
                card.classList.add('flipped');
                const id = parseInt(card.dataset.id);
                studiedCards.add(id);
            });
            updateProgress();
            updateStats();
        }

        function filterCards(category) {
            currentFilter = category;
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('ring-2', 'ring-white');
            });
            event.target.classList.add('ring-2', 'ring-white');
            
            renderCards();
        }

        // Quiz Functions
        function startQuiz() {
            quizState = {
                currentQuestion: 0,
                score: 0,
                answers: [],
                startTime: new Date(),
                timer: null
            };
            
            document.getElementById('start-quiz-btn').style.display = 'none';
            document.getElementById('quiz-container').classList.remove('hidden');
            
            startTimer();
            showQuestion();
        }

        function startTimer() {
            quizState.timer = setInterval(() => {
                const elapsed = Math.floor((new Date() - quizState.startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('quiz-timer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function showQuestion() {
            const question = quizQuestions[quizState.currentQuestion];
            
            document.getElementById('current-question').textContent = quizState.currentQuestion + 1;
            document.getElementById('total-questions').textContent = quizQuestions.length;
            document.getElementById('current-score').textContent = quizState.score;
            
            const progress = ((quizState.currentQuestion + 1) / quizQuestions.length) * 100;
            document.getElementById('quiz-progress').style.width = `${progress}%`;
            
            document.getElementById('question-text').textContent = question.question;
            document.getElementById('question-category').textContent = `‡∏´‡∏°‡∏ß‡∏î: ${question.category}`;
            
            const optionsContainer = document.getElementById('quiz-options');
            optionsContainer.innerHTML = question.options.map((option, index) => `
                <button class="quiz-option bg-white hover:bg-gray-50 border-2 border-gray-200 rounded-xl p-6 text-left transition-all transform hover:scale-105 shadow-md" 
                        onclick="selectAnswer(${index})">
                    <div class="font-medium text-gray-800">${String.fromCharCode(65 + index)}. ${option}</div>
                </button>
            `).join('');
            
            document.getElementById('next-btn').disabled = true;
        }

        function selectAnswer(selectedIndex) {
            const question = quizQuestions[quizState.currentQuestion];
            const options = document.querySelectorAll('.quiz-option');
            
            options.forEach((option, index) => {
                option.classList.add('disabled');
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedIndex && index !== question.correct) {
                    option.classList.add('incorrect');
                }
            });
            
            if (selectedIndex === question.correct) {
                quizState.score++;
            }
            
            quizState.answers.push({
                question: question.question,
                selected: selectedIndex,
                correct: question.correct,
                isCorrect: selectedIndex === question.correct
            });
            
            document.getElementById('current-score').textContent = quizState.score;
            document.getElementById('next-btn').disabled = false;
        }

        function nextQuestion() {
            quizState.currentQuestion++;
            
            if (quizState.currentQuestion >= quizQuestions.length) {
                finishQuiz();
            } else {
                showQuestion();
            }
        }

        function finishQuiz() {
            clearInterval(quizState.timer);
            
            const endTime = new Date();
            const duration = Math.floor((endTime - quizState.startTime) / 1000);
            const percentage = Math.round((quizState.score / quizQuestions.length) * 100);
            
            const result = {
                date: endTime.toLocaleDateString('th-TH'),
                time: endTime.toLocaleTimeString('th-TH'),
                score: quizState.score,
                total: quizQuestions.length,
                percentage: percentage,
                duration: duration,
                answers: quizState.answers
            };
            
            quizResults.push(result);
            localStorage.setItem('quizResults', JSON.stringify(quizResults));
            
            showQuizResult(result);
        }

        function showQuizResult(result) {
            const grade = result.percentage >= 80 ? 'A' : result.percentage >= 70 ? 'B' : result.percentage >= 60 ? 'C' : result.percentage >= 50 ? 'D' : 'F';
            const gradeColor = result.percentage >= 80 ? 'text-green-600' : result.percentage >= 60 ? 'text-yellow-600' : 'text-red-600';
            
            document.getElementById('quiz-container').innerHTML = `
                <div class="text-center">
                    <div class="text-6xl mb-4">${result.percentage >= 80 ? 'üéâ' : result.percentage >= 60 ? 'üëç' : 'üòî'}</div>
                    <h3 class="text-3xl font-bold text-gray-800 mb-4">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</h3>
                    <div class="bg-gray-50 rounded-xl p-8 mb-6">
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                            <div>
                                <div class="text-2xl font-bold text-blue-600">${result.score}/${result.total}</div>
                                <div class="text-sm text-gray-600">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-purple-600">${result.percentage}%</div>
                                <div class="text-sm text-gray-600">‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold ${gradeColor}">${grade}</div>
                                <div class="text-sm text-gray-600">‡πÄ‡∏Å‡∏£‡∏î</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-orange-600">${Math.floor(result.duration / 60)}:${(result.duration % 60).toString().padStart(2, '0')}</div>
                                <div class="text-sm text-gray-600">‡πÄ‡∏ß‡∏•‡∏≤</div>
                            </div>
                        </div>
                    </div>
                    <div class="space-x-4">
                        <button onclick="resetQuiz()" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg">
                            üîÑ ‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà
                        </button>
                        <button onclick="switchMode('results')" class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white px-8 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg">
                            üìä ‡∏î‡∏π‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                        </button>
                    </div>
                </div>
            `;
        }

        function resetQuiz() {
            quizState = {
                currentQuestion: 0,
                score: 0,
                answers: [],
                startTime: null,
                timer: null
            };
            
            document.getElementById('start-quiz-btn').style.display = 'inline-block';
            document.getElementById('quiz-container').innerHTML = `
                <div class="text-center">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á?</h3>
                    <p class="text-gray-600 mb-8">‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡∏°‡∏µ ${quizQuestions.length} ‡∏Ç‡πâ‡∏≠ ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 10-15 ‡∏ô‡∏≤‡∏ó‡∏µ</p>
                    <div class="text-6xl">üß†</div>
                </div>
            `;
            
            document.getElementById('current-question').textContent = '1';
            document.getElementById('current-score').textContent = '0';
            document.getElementById('quiz-timer').textContent = '00:00';
            document.getElementById('quiz-progress').style.width = '10%';
        }

        // Results Functions
        function loadResults() {
            const totalAttempts = quizResults.length;
            const averageScore = totalAttempts > 0 ? Math.round(quizResults.reduce((sum, result) => sum + result.percentage, 0) / totalAttempts) : 0;
            const bestScore = totalAttempts > 0 ? Math.max(...quizResults.map(result => result.percentage)) : 0;
            
            document.getElementById('total-attempts').textContent = totalAttempts;
            document.getElementById('average-score').textContent = `${averageScore}%`;
            document.getElementById('best-score').textContent = `${bestScore}%`;
            
            const tableBody = document.getElementById('results-table');
            tableBody.innerHTML = quizResults.map((result, index) => {
                const grade = result.percentage >= 80 ? 'A' : result.percentage >= 70 ? 'B' : result.percentage >= 60 ? 'C' : result.percentage >= 50 ? 'D' : 'F';
                const gradeColor = result.percentage >= 80 ? 'text-green-600' : result.percentage >= 60 ? 'text-yellow-600' : 'text-red-600';
                
                return `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${index + 1}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${result.date}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${result.score}/${result.total} (${result.percentage}%)</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${Math.floor(result.duration / 60)}:${(result.duration % 60).toString().padStart(2, '0')}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium ${gradeColor}">${grade}</td>
                    </tr>
                `;
            }).join('');
        }

        function exportResults() {
            if (quizResults.length === 0) {
                alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å');
                return;
            }
            
            const csvContent = "data:text/csv;charset=utf-8," 
                + "‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà,‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà,‡πÄ‡∏ß‡∏•‡∏≤,‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô,‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå,‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ,‡πÄ‡∏Å‡∏£‡∏î\n"
                + quizResults.map((result, index) => {
                    const grade = result.percentage >= 80 ? 'A' : result.percentage >= 70 ? 'B' : result.percentage >= 60 ? 'C' : result.percentage >= 50 ? 'D' : 'F';
                    return `${index + 1},${result.date},${result.time},${result.score}/${result.total},${result.percentage}%,${Math.floor(result.duration / 60)}:${(result.duration % 60).toString().padStart(2, '0')},${grade}`;
                }).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "quiz_results.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function clearResults() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                quizResults = [];
                localStorage.removeItem('quizResults');
                loadResults();
            }
        }

        // Initialize
        renderCards();
        updateStats();
        resetQuiz();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98f07fa242fc8963',t:'MTc2MDU0MzcwMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html><!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPR Medications Learning System - Google Apps Script Version</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { box-sizing: border-box; }
        /* ‡πÄ‡∏û‡∏¥‡πà‡∏° CSS styles ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å */
    </style>
</head>
<body>
    <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ HTML ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å -->
    
    <script>
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Apps Script
        function saveResultToSheet(resultData) {
            google.script.run
                .withSuccessHandler(onSaveSuccess)
                .withFailureHandler(onSaveFailure)
                .saveQuizResult(resultData);
        }
        
        function onSaveSuccess(result) {
            console.log('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', result);
        }
        
        function onSaveFailure(error) {
            console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:', error);
        }
        
        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô finishQuiz ‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Google Sheets
        function finishQuiz() {
            clearInterval(quizState.timer);
            
            const endTime = new Date();
            const duration = Math.floor((endTime - quizState.startTime) / 1000);
            const percentage = Math.round((quizState.score / quizQuestions.length) * 100);
            
            const result = {
                date: endTime.toLocaleDateString('th-TH'),
                time: endTime.toLocaleTimeString('th-TH'),
                score: quizState.score,
                total: quizQuestions.length,
                percentage: percentage,
                duration: duration,
                answers: quizState.answers
            };
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage
            quizResults.push(result);
            localStorage.setItem('quizResults', JSON.stringify(quizResults));
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Google Sheets
            saveResultToSheet(result);
            
            showQuizResult(result);
        }
        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡πâ‡∏î JavaScript ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å
    </script>
</body>
</html>

